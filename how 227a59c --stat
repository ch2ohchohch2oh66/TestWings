[1mdiff --git a/android/app/src/main/java/com/testwings/MainActivity.kt b/android/app/src/main/java/com/testwings/MainActivity.kt[m
[1mindex 4e7cc07..3ae3163 100644[m
[1m--- a/android/app/src/main/java/com/testwings/MainActivity.kt[m
[1m+++ b/android/app/src/main/java/com/testwings/MainActivity.kt[m
[36m@@ -314,6 +314,13 @@[m [mclass MainActivity : ComponentActivity() {[m
         }[m
     }[m
     [m
[32m+[m[32m    override fun onResume() {[m
[32m+[m[32m        super.onResume()[m
[32m+[m[32m        // å½“Activityæ¢å¤æ—¶ï¼ˆä¾‹å¦‚ä»è®¾ç½®é¡µé¢è¿”å›ï¼‰ï¼Œåˆ·æ–°æ— éšœç¢æœåŠ¡çŠ¶æ€[m
[32m+[m[32m        // è¿™ä¼šè§¦å‘Composeé‡æ–°æ£€æŸ¥çŠ¶æ€[m
[32m+[m[32m        // æ³¨æ„ï¼šè¿™é‡Œä¸éœ€è¦æ‰‹åŠ¨åˆ·æ–°ï¼Œå› ä¸ºMainScreenä¸­çš„LaunchedEffectä¼šåœ¨Activityæ¢å¤æ—¶é‡æ–°æ‰§è¡Œ[m
[32m+[m[32m    }[m
[32m+[m[41m    [m
     override fun onDestroy() {[m
         super.onDestroy()[m
         virtualDisplay?.release()[m
[36m@@ -330,16 +337,29 @@[m [mfun MainScreen([m
     val context = androidx.compose.ui.platform.LocalContext.current[m
     var isAccessibilityEnabled by remember { mutableStateOf(false) }[m
     [m
[31m-    // æ£€æŸ¥æ— éšœç¢æœåŠ¡çŠ¶æ€[m
[32m+[m[32m    // å°†æ“ä½œè®¡æ•°çŠ¶æ€æå‡åˆ° MainScreenï¼Œé¿å…é¡µé¢åˆ‡æ¢æ—¶ä¸¢å¤±[m
[32m+[m[32m    var clickCount by remember { mutableStateOf(0) }[m
[32m+[m[32m    var swipeUpCount by remember { mutableStateOf(0) }[m
[32m+[m[32m    var swipeDownCount by remember { mutableStateOf(0) }[m
[32m+[m[32m    var swipeLeftCount by remember { mutableStateOf(0) }[m
[32m+[m[32m    var swipeRightCount by remember { mutableStateOf(0) }[m
[32m+[m[32m    var lastOperation by remember { mutableStateOf<String?>(null) }[m
[32m+[m[41m    [m
[32m+[m[32m    // åˆ·æ–°æ— éšœç¢æœåŠ¡çŠ¶æ€çš„å‡½æ•°[m
[32m+[m[32m    val refreshAccessibilityStatus: () -> Unit = {[m
[32m+[m[32m        isAccessibilityEnabled = DeviceController.isAccessibilityServiceEnabled(context)[m
[32m+[m[32m    }[m
[32m+[m[41m    [m
[32m+[m[32m    // æ£€æŸ¥æ— éšœç¢æœåŠ¡çŠ¶æ€ï¼ˆä¼ å…¥contextä»¥æé«˜å‡†ç¡®æ€§ï¼‰[m
     LaunchedEffect(Unit) {[m
[31m-        isAccessibilityEnabled = DeviceController.isAccessibilityServiceEnabled()[m
[32m+[m[32m        isAccessibilityEnabled = DeviceController.isAccessibilityServiceEnabled(context)[m
     }[m
     [m
[31m-    // å®šæœŸæ£€æŸ¥æœåŠ¡çŠ¶æ€[m
[32m+[m[32m    // å®šæœŸæ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼ˆä¼ å…¥contextä»¥æé«˜å‡†ç¡®æ€§ï¼‰[m
     LaunchedEffect(Unit) {[m
         while (true) {[m
             kotlinx.coroutines.delay(1000)[m
[31m-            isAccessibilityEnabled = DeviceController.isAccessibilityServiceEnabled()[m
[32m+[m[32m            isAccessibilityEnabled = DeviceController.isAccessibilityServiceEnabled(context)[m
         }[m
     }[m
     [m
[36m@@ -359,7 +379,20 @@[m [mfun MainScreen([m
                 onCaptureClick = onCaptureClick,[m
                 onOpenAccessibilitySettings = onOpenAccessibilitySettings,[m
                 isAccessibilityEnabled = isAccessibilityEnabled,[m
[31m-                pagerState = pagerState[m
[32m+[m[32m                onRefreshAccessibilityStatus = refreshAccessibilityStatus,[m
[32m+[m[32m                pagerState = pagerState,[m
[32m+[m[32m                clickCount = clickCount,[m
[32m+[m[32m                swipeUpCount = swipeUpCount,[m
[32m+[m[32m                swipeDownCount = swipeDownCount,[m
[32m+[m[32m                swipeLeftCount = swipeLeftCount,[m
[32m+[m[32m                swipeRightCount = swipeRightCount,[m
[32m+[m[32m                lastOperation = lastOperation,[m
[32m+[m[32m                onClickCountChange = { clickCount = it },[m
[32m+[m[32m                onSwipeUpCountChange = { swipeUpCount = it },[m
[32m+[m[32m                onSwipeDownCountChange = { swipeDownCount = it },[m
[32m+[m[32m                onSwipeLeftCountChange = { swipeLeftCount = it },[m
[32m+[m[32m                onSwipeRightCountChange = { swipeRightCount = it },[m
[32m+[m[32m                onLastOperationChange = { lastOperation = it }[m
             )[m
             2 -> RightPage()  // å³ä¾§ç©ºç™½é¡µ[m
         }[m
[36m@@ -374,7 +407,20 @@[m [mfun MainContentPage([m
     onCaptureClick: () -> Unit,[m
     onOpenAccessibilitySettings: () -> Unit,[m
     isAccessibilityEnabled: Boolean,[m
[31m-    pagerState: PagerState[m
[32m+[m[32m    onRefreshAccessibilityStatus: () -> Unit,[m
[32m+[m[32m    pagerState: PagerState,[m
[32m+[m[32m    clickCount: Int,[m
[32m+[m[32m    swipeUpCount: Int,[m
[32m+[m[32m    swipeDownCount: Int,[m
[32m+[m[32m    swipeLeftCount: Int,[m
[32m+[m[32m    swipeRightCount: Int,[m
[32m+[m[32m    lastOperation: String?,[m
[32m+[m[32m    onClickCountChange: (Int) -> Unit,[m
[32m+[m[32m    onSwipeUpCountChange: (Int) -> Unit,[m
[32m+[m[32m    onSwipeDownCountChange: (Int) -> Unit,[m
[32m+[m[32m    onSwipeLeftCountChange: (Int) -> Unit,[m
[32m+[m[32m    onSwipeRightCountChange: (Int) -> Unit,[m
[32m+[m[32m    onLastOperationChange: (String?) -> Unit[m
 ) {[m
     val context = androidx.compose.ui.platform.LocalContext.current[m
     val scrollState = rememberScrollState()[m
[36m@@ -451,10 +497,29 @@[m [mfun MainContentPage([m
                 modifier = Modifier.padding(16.dp),[m
                 verticalArrangement = Arrangement.spacedBy(8.dp)[m
             ) {[m
[31m-                Text([m
[31m-                    text = "æ— éšœç¢æœåŠ¡çŠ¶æ€",[m
[31m-                    style = MaterialTheme.typography.titleMedium[m
[31m-                )[m
[32m+[m[32m                Row([m
[32m+[m[32m                    modifier = Modifier.fillMaxWidth(),[m
[32m+[m[32m                    horizontalArrangement = Arrangement.SpaceBetween,[m
[32m+[m[32m                    verticalAlignment = Alignment.CenterVertically[m
[32m+[m[32m                ) {[m
[32m+[m[32m                    Text([m
[32m+[m[32m                        text = "æ— éšœç¢æœåŠ¡çŠ¶æ€",[m
[32m+[m[32m                        style = MaterialTheme.typography.titleMedium[m
[32m+[m[32m                    )[m
[32m+[m[32m                    // åˆ·æ–°æŒ‰é’®[m
[32m+[m[32m                    TextButton([m
[32m+[m[32m                        onClick = {[m
[32m+[m[32m                            onRefreshAccessibilityStatus()[m
[32m+[m[32m                            android.widget.Toast.makeText([m
[32m+[m[32m                                context,[m
[32m+[m[32m                                "å·²åˆ·æ–°çŠ¶æ€",[m
[32m+[m[32m                                android.widget.Toast.LENGTH_SHORT[m
[32m+[m[32m                            ).show()[m
[32m+[m[32m                        }[m
[32m+[m[32m                    ) {[m
[32m+[m[32m                        Text("ğŸ”„ åˆ·æ–°")[m
[32m+[m[32m                    }[m
[32m+[m[32m                }[m
                 Text([m
                     text = if (isAccessibilityEnabled) "âœ… å·²å¯ç”¨" else "âŒ æœªå¯ç”¨",[m
                     style = MaterialTheme.typography.bodyMedium[m
[36m@@ -495,7 +560,19 @@[m [mfun MainContentPage([m
         if (isAccessibilityEnabled) {[m
             OperationTestSection([m
                 context = context,[m
[31m-                pagerState = pagerState[m
[32m+[m[32m                pagerState = pagerState,[m
[32m+[m[32m                clickCount = clickCount,[m
[32m+[m[32m                swipeUpCount = swipeUpCount,[m
[32m+[m[32m                swipeDownCount = swipeDownCount,[m
[32m+[m[32m                swipeLeftCount = swipeLeftCount,[m
[32m+[m[32m                swipeRightCount = swipeRightCount,[m
[32m+[m[32m                lastOperation = lastOperation,[m
[32m+[m[32m                onClickCountChange = onClickCountChange,[m
[32m+[m[32m                onSwipeUpCountChange = onSwipeUpCountChange,[m
[32m+[m[32m                onSwipeDownCountChange = onSwipeDownCountChange,[m
[32m+[m[32m                onSwipeLeftCountChange = onSwipeLeftCountChange,[m
[32m+[m[32m                onSwipeRightCountChange = onSwipeRightCountChange,[m
[32m+[m[32m                onLastOperationChange = onLastOperationChange[m
             )[m
         }[m
     }[m
[36m@@ -624,15 +701,20 @@[m [mfun ScreenCaptureScreen([m
 @Composable[m
 fun OperationTestSection([m
     context: Context,[m
[31m-    pagerState: PagerState[m
[32m+[m[32m    pagerState: PagerState,[m
[32m+[m[32m    clickCount: Int,[m
[32m+[m[32m    swipeUpCount: Int,[m
[32m+[m[32m    swipeDownCount: Int,[m
[32m+[m[32m    swipeLeftCount: Int,[m
[32m+[m[32m    swipeRightCount: Int,[m
[32m+[m[32m    lastOperation: String?,[m
[32m+[m[32m    onClickCountChange: (Int) -> Unit,[m
[32m+[m[32m    onSwipeUpCountChange: (Int) -> Unit,[m
[32m+[m[32m    onSwipeDownCountChange: (Int) -> Unit,[m
[32m+[m[32m    onSwipeLeftCountChange: (Int) -> Unit,[m
[32m+[m[32m    onSwipeRightCountChange: (Int) -> Unit,[m
[32m+[m[32m    onLastOperationChange: (String?) -> Unit[m
 ) {[m
[31m-    var clickCount by remember { mutableStateOf(0) }[m
[31m-    var swipeUpCount by remember { mutableStateOf(0) }[m
[31m-    var swipeDownCount by remember { mutableStateOf(0) }[m
[31m-    var swipeLeftCount by remember { mutableStateOf(0) }[m
[31m-    var swipeRightCount by remember { mutableStateOf(0) }[m
[31m-    var lastOperation by remember { mutableStateOf<String?>(null) }[m
[31m-    [m
     // è®°å½•æ»‘åŠ¨å‰çš„é¡µé¢ä½ç½®ï¼Œç”¨äºéªŒè¯æ»‘åŠ¨æ“ä½œ[m
     val pageBeforeSwipe = remember { mutableStateOf(pagerState.currentPage) }[m
     [m
[36m@@ -701,12 +783,13 @@[m [mfun OperationTestSection([m
                         Button([m
                             onClick = {[m
                                 val result = DeviceController.click(centerX, centerY)[m
[31m-                                clickCount++[m
[31m-                                lastOperation = if (result) {[m
[31m-                                    "ç‚¹å‡»å±å¹•ä¸­å¿ƒ ($centerX, $centerY) - æˆåŠŸ (ç¬¬ $clickCount æ¬¡)"[m
[32m+[m[32m                                val newCount = clickCount + 1[m
[32m+[m[32m                                onClickCountChange(newCount)[m
[32m+[m[32m                                onLastOperationChange(if (result) {[m
[32m+[m[32m                                    "ç‚¹å‡»å±å¹•ä¸­å¿ƒ ($centerX, $centerY) - æˆåŠŸ (ç¬¬ $newCount æ¬¡)"[m
                                 } else {[m
                                     "ç‚¹å‡»å±å¹•ä¸­å¿ƒ ($centerX, $centerY) - å¤±è´¥"[m
[31m-                                }[m
[32m+[m[32m                                })[m
                                 android.widget.Toast.makeText([m
                                     context,[m
                                     if (result) "âœ… ç‚¹å‡»æˆåŠŸï¼" else "âŒ ç‚¹å‡»å¤±è´¥",[m
[36m@@ -755,12 +838,13 @@[m [mfun OperationTestSection([m
                         Button([m
                             onClick = {[m
                                 val result = DeviceController.swipeUp()[m
[31m-                                swipeUpCount++[m
[31m-                                lastOperation = if (result) {[m
[31m-                                    "å‘ä¸Šæ»‘åŠ¨ - æˆåŠŸ (ç¬¬ $swipeUpCount æ¬¡)"[m
[32m+[m[32m                                val newCount = swipeUpCount + 1[m
[32m+[m[32m                                onSwipeUpCountChange(newCount)[m
[32m+[m[32m                                onLastOperationChange(if (result) {[m
[32m+[m[32m                                    "å‘ä¸Šæ»‘åŠ¨ - æˆåŠŸ (ç¬¬ $newCount æ¬¡)"[m
                                 } else {[m
                                     "å‘ä¸Šæ»‘åŠ¨ - å¤±è´¥"[m
[31m-                                }[m
[32m+[m[32m                                })[m
                                 android.widget.Toast.makeText([m
                                     context,[m
                                     if (result) "âœ… å‘ä¸Šæ»‘åŠ¨å·²æ‰§è¡Œï¼" else "âŒ æ»‘åŠ¨å¤±è´¥",[m
[36m@@ -785,12 +869,13 @@[m [mfun OperationTestSection([m
                         Button([m
                             onClick = {[m
                                 val result = DeviceController.swipeDown()[m
[31m-                                swipeDownCount++[m
[31m-                                lastOperation = if (result) {[m
[31m-                                    "å‘ä¸‹æ»‘åŠ¨ - æˆåŠŸ (ç¬¬ $swipeDownCount æ¬¡)"[m
[32m+[m[32m                                val newCount = swipeDownCount + 1[m
[32m+[m[32m                                onSwipeDownCountChange(newCount)[m
[32m+[m[32m                                onLastOperationChange(if (result) {[m
[32m+[m[32m                                    "å‘ä¸‹æ»‘åŠ¨ - æˆåŠŸ (ç¬¬ $newCount æ¬¡)"[m
                                 } else {[m
                                     "å‘ä¸‹æ»‘åŠ¨ - å¤±è´¥"[m
[31m-                                }[m
[32m+[m[32m                                })[m
                                 android.widget.Toast.makeText([m
                                     context,[m
                                     if (result) "âœ… å‘ä¸‹æ»‘åŠ¨å·²æ‰§è¡Œï¼" else "âŒ æ»‘åŠ¨å¤±è´¥",[m
[36m@@ -818,28 +903,29 @@[m [mfun OperationTestSection([m
                                 // è®°å½•æ»‘åŠ¨å‰çš„é¡µé¢ä½ç½®[m
                                 pageBeforeSwipe.value = pagerState.currentPage[m
                                 val result = DeviceController.swipeLeft()[m
[31m-                                swipeLeftCount++[m
[32m+[m[32m                                val newCount = swipeLeftCount + 1[m
[32m+[m[32m                                onSwipeLeftCountChange(newCount)[m
                                 // å»¶è¿Ÿæ£€æŸ¥é¡µé¢æ˜¯å¦åˆ‡æ¢ï¼ˆç»™æ»‘åŠ¨æ“ä½œæ—¶é—´æ‰§è¡Œï¼‰[m
                                 CoroutineScope(Dispatchers.Main).launch {[m
                                     delay(300) // ç­‰å¾…300msè®©æ»‘åŠ¨æ“ä½œå®Œæˆ[m
                                     val newPage = pagerState.currentPage[m
                                     if (newPage > pageBeforeSwipe.value) {[m
                                         // é¡µé¢å‘å³åˆ‡æ¢äº†ï¼ˆä»ä¸»é¡µåˆ‡æ¢åˆ°å³ä¾§é¡µï¼‰ï¼Œè¯´æ˜å‘å·¦æ»‘åŠ¨æˆåŠŸ[m
[31m-                                        lastOperation = "å‘å·¦æ»‘åŠ¨ - æˆåŠŸ (ç¬¬ $swipeLeftCount æ¬¡) - é¡µé¢å·²åˆ‡æ¢"[m
[32m+[m[32m                                        onLastOperationChange("å‘å·¦æ»‘åŠ¨ - æˆåŠŸ (ç¬¬ $newCount æ¬¡) - é¡µé¢å·²åˆ‡æ¢")[m
                                         android.widget.Toast.makeText([m
                                             context,[m
                                             "âœ… å‘å·¦æ»‘åŠ¨æˆåŠŸï¼é¡µé¢å·²åˆ‡æ¢",[m
                                             android.widget.Toast.LENGTH_SHORT[m
                                         ).show()[m
                                     } else if (result) {[m
[31m-                                        lastOperation = "å‘å·¦æ»‘åŠ¨ - å·²æ‰§è¡Œ (ç¬¬ $swipeLeftCount æ¬¡)"[m
[32m+[m[32m                                        onLastOperationChange("å‘å·¦æ»‘åŠ¨ - å·²æ‰§è¡Œ (ç¬¬ $newCount æ¬¡)")[m
                                         android.widget.Toast.makeText([m
                                             context,[m
                                             "âœ… å‘å·¦æ»‘åŠ¨å·²æ‰§è¡Œï¼",[m
                                             android.widget.Toast.LENGTH_SHORT[m
                                         ).show()[m
                                     } else {[m
[31m-                                        lastOperation = "å‘å·¦æ»‘åŠ¨ - å¤±è´¥"[m
[32m+[m[32m                                        onLastOperationChange("å‘å·¦æ»‘åŠ¨ - å¤±è´¥")[m
                                         android.widget.Toast.makeText([m
                                             context,[m
                                             "âŒ æ»‘åŠ¨å¤±è´¥",[m
[36m@@ -868,28 +954,29 @@[m [mfun OperationTestSection([m
                                 // è®°å½•æ»‘åŠ¨å‰çš„é¡µé¢ä½ç½®[m
                                 pageBeforeSwipe.value = pagerState.currentPage[m
                                 val result = DeviceController.swipeRight()[m
[31m-                                swipeRightCount++[m
[32m+[m[32m                                val newCount = swipeRightCount + 1[m
[32m+[m[32m                                onSwipeRightCountChange(newCount)[m
                                 // å»¶è¿Ÿæ£€æŸ¥é¡µé¢æ˜¯å¦åˆ‡æ¢ï¼ˆç»™æ»‘åŠ¨æ“ä½œæ—¶é—´æ‰§è¡Œï¼‰[m
                                 CoroutineScope(Dispatchers.Main).launch {[m
                                     delay(300) // ç­‰å¾…300msè®©æ»‘åŠ¨æ“ä½œå®Œæˆ[m
                                     val newPage = pagerState.currentPage[m
                                     if (newPage < pageBeforeSwipe.value) {[m
                                         // é¡µé¢å‘å·¦åˆ‡æ¢äº†ï¼ˆä»ä¸»é¡µåˆ‡æ¢åˆ°å·¦ä¾§é¡µï¼‰ï¼Œè¯´æ˜å‘å³æ»‘åŠ¨æˆåŠŸ[m
[31m-                                        lastOperation = "å‘å³æ»‘åŠ¨ - æˆåŠŸ (ç¬¬ $swipeRightCount æ¬¡) - é¡µé¢å·²åˆ‡æ¢"[m
[32m+[m[32m                                        onLastOperationChange("å‘å³æ»‘åŠ¨ - æˆåŠŸ (ç¬¬ $newCount æ¬¡) - é¡µé¢å·²åˆ‡æ¢")[m
                                         android.widget.Toast.makeText([m
                                             context,[m
                                             "âœ… å‘å³æ»‘åŠ¨æˆåŠŸï¼é¡µé¢å·²åˆ‡æ¢",[m
                                             android.widget.Toast.LENGTH_SHORT[m
                                         ).show()[m
                                     } else if (result) {[m
[31m-                                        lastOperation = "å‘å³æ»‘åŠ¨ - å·²æ‰§è¡Œ (ç¬¬ $swipeRightCount æ¬¡)"[m
[32m+[m[32m                                        onLastOperationChange("å‘å³æ»‘åŠ¨ - å·²æ‰§è¡Œ (ç¬¬ $newCount æ¬¡)")[m
                                         android.widget.Toast.makeText([m
                                             context,[m
                                             "âœ… å‘å³æ»‘åŠ¨å·²æ‰§è¡Œï¼",[m
                                             android.widget.Toast.LENGTH_SHORT[m
                                         ).show()[m
                                     } else {[m
[31m-                                        lastOperation = "å‘å³æ»‘åŠ¨ - å¤±è´¥"[m
[32m+[m[32m                                        onLastOperationChange("å‘å³æ»‘åŠ¨ - å¤±è´¥")[m
                                         android.widget.Toast.makeText([m
                                             context,[m
                                             "âŒ æ»‘åŠ¨å¤±è´¥",[m
[36m@@ -928,11 +1015,11 @@[m [mfun OperationTestSection([m
                     Button([m
                         onClick = {[m
                             val result = DeviceController.pressBack()[m
[31m-                            lastOperation = if (result) {[m
[32m+[m[32m                            onLastOperationChange(if (result) {[m
                                 "è¿”å›é”® - æˆåŠŸ"[m
                             } else {[m
                                 "è¿”å›é”® - å¤±è´¥"[m
[31m-                            }[m
[32m+[m[32m                            })[m
                             android.widget.Toast.makeText([m
                                 context,[m
                                 if (result) "âœ… è¿”å›é”®æˆåŠŸï¼" else "âŒ è¿”å›é”®å¤±è´¥",[m
